// Add below UI elements gathering:
const chatModal = document.getElementById('chatModal');
const chatUserName = document.getElementById('chatUserName');
const chatCloseBtn = document.getElementById('chatCloseBtn');
const chatMessages = document.getElementById('chatMessages');
const chatInputForm = document.getElementById('chatInputForm');

let currentChatId = null;
let chatListenerUnsubscribe = null;

// Show users in sidebar (for demo):
function listenForUsers() {
  const usersQuery = query(collection(db, 'users'));
  const usersList = document.getElementById('usersList'); // Add a div <div id="usersList"></div> in sidebar
  onSnapshot(usersQuery, (snapshot) => {
    usersList.innerHTML = '';
    snapshot.forEach((doc) => {
      const user = doc.data();
      if (user.uid === auth.currentUser.uid) return;
      const userEl = document.createElement('a');
      userEl.className = 'sidebar-item';
      userEl.innerHTML = `<img src="${user.photoURL}" class="sidebar-avatar"><span class="sidebar-text">${user.displayName}</span>`;
      userEl.onclick = () => openChat(user.uid, user.displayName);
      usersList.appendChild(userEl);
    });
  });
}
